# Handoff: R6 Build Engine

**Fecha**: 2026-02-16
**Rol**: R6 Build Engine
**Estado**: ✅ Completado (MVP)

## Resumen Ejecutivo

Motor de optimización de builds implementado en el backend. Expone una API para calcular las mejores combinaciones de armadura basándose en las prioridades de estadísticas del usuario y un exótico obligatorio opcional.

## Entregables Técnicos

### 1. Motor de Cálculo (`src/lib/builds/engine.ts`)

- **Algoritmo**: DFS (Depth First Search) con poda básica.
- **Entrada**: Items de inventario planos + Objetivos (Stats, Exótico).
- **Salida**: Top 20 combinaciones ordenadas por "Score" (Tiers totales + cumplimiento de objetivos).

### 2. API Endpoint (`/api/builds/optimize`)

- **Método**: POST.
- **Body**: `{ classType: number, statPriority: number[6], lockedExoticHash?: number }`.
- **Integración**: Obtiene el inventario del usuario automáticamente (`getFullProfile`) y filtra items relevantes antes de procesar.

## Limitaciones MVP

- **Mods**: No calcula mods (+10/+5). Solo stats base + Masterwork (+12 total).
- **Fragments**: No considera bonus de fragmentos (-10/+10).
- **Performance**: Ejecución síncrona en Node.js. Inventarios muy grandes podrían causar timeouts en serverless (Vercel duration limit).

## Siguientes Pasos (Handoff a R7/R8)

- **R8 Frontend** debe visualizar los resultados y permitir "Aplicar" el build (usando R5 `applyLoadout` pero necesitaría crear el loadout primero).
- **R7 AI** puede usar este motor para "Sugerir un build" basado en lenguaje natural ("Quiero un build de Void agresivo").
